<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>批量展示图片</title>
	<style>
		/* 全局样式 */
		body {
			font-family: 'Roboto', Arial, sans-serif;
			margin: 0;
			padding: 20px;
			background-color: #f4f6f9;
			color: #333;
		}

		h1 {
			text-align: center;
			color: #333;
			font-size: 2rem;
			margin-bottom: 20px;
		}

		p {
			text-align: center;
			font-size: 1rem;
			color: #666;
		}

		textarea {
			width: 100%;
			height: 150px;
			margin-bottom: 20px;
			font-size: 1rem;
			border: 1px solid #ddd;
			border-radius: 8px;
			padding: 10px;
			background: #fff;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		button {
			padding: 10px 20px;
			font-size: 1rem;
			cursor: pointer;
			border: none;
			border-radius: 5px;
			background: linear-gradient(90deg, #4caf50, #2e7d32);
			color: #fff;
			transition: all 0.3s ease;
		}

		button:hover {
			background: linear-gradient(90deg, #66bb6a, #388e3c);
		}

		#gallery {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
			gap: 20px;
			margin-top: 20px;
		}

		.image-container {
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			align-items: center;
			text-align: center;
			border: 1px solid #ddd;
			border-radius: 8px;
			padding: 15px;
			background-color: #fff;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			position: relative;
			height: 350px;
			transition: transform 0.3s, box-shadow 0.3s;
		}

		.image-container:hover {
			transform: translateY(-5px);
			box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
		}

		.image-container img {
			max-width: 100%;
			max-height: 250px;
			object-fit: cover;
			border-radius: 5px;
			cursor: pointer;
		}

		.image-placeholder {
			display: flex;
			justify-content: center;
			align-items: center;
			width: 100%;
			height: 250px;
			background-color: #ececec;
			color: #888;
			font-size: 16px;
			border-radius: 5px;
		}

		.action-buttons {
			display: flex;
			justify-content: space-around;
			width: 100%;
			margin-top: 10px;
		}

		.action-buttons button {
			background: linear-gradient(90deg, #42a5f5, #1e88e5);
			color: #fff;
			border: none;
			padding: 10px;
			border-radius: 5px;
			cursor: pointer;
			transition: background 0.3s;
		}

		.action-buttons button:hover {
			background: linear-gradient(90deg, #64b5f6, #2196f3);
		}

		/* 模态框样式 */
		.modal {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.9);
			z-index: 1000;
			justify-content: center;
			align-items: center;
		}

		.modal img {
			max-width: 90%;
			max-height: 90%;
			cursor: zoom-in;
			transition: transform 0.3s ease-in-out;
		}

		.modal img.zoomed {
			cursor: zoom-out;
			transform: scale(2);
		}

		.modal-close {
			position: absolute;
			top: 20px;
			right: 20px;
			color: white;
			font-size: 30px;
			font-weight: bold;
			cursor: pointer;
			z-index: 1001;
		}
	</style>
</head>

<body>
	<h1>批量展示图片</h1>
	<p>在下方粘贴图片 URL，每行一个：</p>
	<textarea id="imageUrls" placeholder="输入图片 URL，每行一个"></textarea>
	<div style="text-align: center;">
		<button onclick="displayImages()">展示图片</button>
		<button onclick="displayUniqueImages()">去重展示</button>
	</div>
	<div id="gallery"></div>

	<div style="text-align: center; margin-top: 20px;">
		<button onclick="copySelectedUrls('A')">复制A类标注URL</button>
		<button onclick="copySelectedUrls('B')">复制B类标注URL</button>
		<button onclick="copySelectedUrls('C')">复制C类标注URL</button>
		<button onclick="downloadSelectedImages()">批量下载</button>
	</div>

	<!-- 模态框 -->
	<div class="modal" id="modal">
		<span class="modal-close" onclick="closeModal()">×</span>
		<img id="modalImage" src="" alt="放大图片">
	</div>

	<script>
		let selectedUrls = new Set();
		let labeledUrls = { A: [], B: [], C: [] }; // 存储每类标注的URL

		function displayImages() {
			const urls = getInputUrls();
			renderGallery(urls);
		}

		function displayUniqueImages() {
			const urls = deduplicateUrls(getInputUrls());
			renderGallery(urls);
		}

		function getInputUrls() {
			const textarea = document.getElementById('imageUrls');
			return textarea.value.split('\n').map(url => url.trim()).filter(url => url);
		}

		function deduplicateUrls(urls) {
			const unique = new Set(urls.map(url => new URL(url).href.split('?')[0]));
			return Array.from(unique);
		}

		function renderGallery(urls) {
			const gallery = document.getElementById('gallery');
			gallery.innerHTML = '';
			selectedUrls.clear();

			urls.forEach(url => {
				const container = document.createElement('div');
				container.className = 'image-container';

				const img = document.createElement('img');
				img.src = url;
				img.onerror = () => (img.style.display = 'none');
				img.onclick = () => openModal(url);

				const actions = document.createElement('div');
				actions.className = 'action-buttons';

				// 添加ABC标注按钮
				const labelBtnA = document.createElement('button');
				labelBtnA.textContent = '标注A类';
				labelBtnA.onclick = () => labelImage(url, 'A');

				const labelBtnB = document.createElement('button');
				labelBtnB.textContent = '标注B类';
				labelBtnB.onclick = () => labelImage(url, 'B');

				const labelBtnC = document.createElement('button');
				labelBtnC.textContent = '标注C类';
				labelBtnC.onclick = () => labelImage(url, 'C');

				actions.append(labelBtnA, labelBtnB, labelBtnC);
				container.append(img, actions);
				gallery.append(container);
			});
		}

		function labelImage(url, label) {
			labeledUrls[label].push(url);
			alert(`已为图片标注为: ${label}`);
		}

		function copySelectedUrls(label) {
			const labelUrls = labeledUrls[label].join('\n');
			navigator.clipboard.writeText(labelUrls);
			alert(`${label}类的标注URL已复制！`);
		}

		function downloadSelectedImages() {
			// 假设图片下载逻辑（这里只是个简单示例，实际需要根据文件下载功能做调整）
			const urls = Array.from(selectedUrls).join('\n');
			alert(`已选中图片 URL: \n${urls}`);
		}

		function openModal(url) {
			const modal = document.getElementById('modal');
			const modalImage = document.getElementById('modalImage');
			modalImage.src = url;
			modal.style.display = 'flex';
		}

		function closeModal() {
			document.getElementById('modal').style.display = 'none';
		}

		// Esc键退出大图模式
		document.addEventListener('keydown', function (e) {
			if (e.key === 'Escape') {
				closeModal();
			}
		});
	</script>
</body>

</html>
